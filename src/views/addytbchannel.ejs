<!-- guildcontentmain.ejs -->
<!DOCTYPE html>
<html lang="pt-br" class="h-full bg-gray-900">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard: <%= info.name %></title>
    <link href="../css/cssdir/out.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  </head>
  <body class="min-h-screen flex items-center justify-center">
    <div class="pages_cont p-8 rounded-lg shadow-md w-full max-w-7xl">
      <!-- Popup de mensagens -->
      <div id="mensagemPopUp" class="hidden fixed top-15 right-5 z-50"></div>

      <!-- Bloco de informações da guilda -->
      <div class="sm:mx-auto sm:w-full sm:max-w-sm">
        <% if (info.icon && info.icon.indexOf('null') === -1) { %>
          <img src="<%= info.icon %>" alt="Ícone da guilda" class="mx-auto h-20 w-20 rounded-full" />
        <% } else { %>
          <img src="/res/serverIcon/nonserverimg.jpg" alt="Ícone padrão" class="mx-auto h-20 w-20 rounded-full" />
        <% } %>

        <h1 class="mt-6 text-center text-3xl font-bold tracking-tight text-white">Guilda <%= info.name %></h1>
        <div class="mt-2 text-center text-sm text-gray-400">
          <p>ID da Guilda: <%= info.id %></p>
          <p>Membros: <%= info.memberCount %></p>
        </div>
      </div>

      <!-- Formulário -->
      <div class="mt-8 sm:mx-auto sm:w-full sm:max-w-sm">
        <form id="addytbchannel" method="post" class="space-y-6">
          <div>
            <label for="channelId" class="block text-sm font-medium leading-6 text-gray-100">Nome do canal</label>
            <div class="mt-2">
              <input 
                type="text" 
                id="channelId" 
                name="channelId" 
                required
                placeholder="Nome do canal no Youtube"
                class="block w-full rounded-md bg-white/5 px-3 py-1.5 text-base text-white 
                       outline-1 -outline-offset-1 outline-white/10 
                       placeholder:text-gray-500 
                       focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-500 sm:text-sm/6"
              />
            </div>
          </div>

          <input type="hidden" id="guildId" name="guildId" value="<%= info.id %>" />
          <input type="hidden" id="func" name="func" value="addyoutubech" />

          <div>
            <button 
              type="button" 
              onclick="envdata()" 
              class="flex w-full justify-center rounded-md bg-indigo-500 px-3 py-1.5 
                     text-sm font-semibold leading-6 text-white hover:bg-indigo-400 
                     focus-visible:outline 
                     focus-visible:outline-offset-2 focus-visible:outline-indigo-500">
              Adicionar Canal
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Scripts -->
    <script>
      function exibirMensagemErro(mensagem) {
        const popUp = document.getElementById('mensagemPopUp');
        popUp.innerHTML = `
          <div class="bg-red-500 text-white font-bold rounded-lg px-4 py-3 shadow-xl" role="alert">
            <p>${mensagem}</p>
          </div>
        `;
        popUp.classList.remove('hidden');
        setTimeout(() => { popUp.classList.add('hidden'); }, 3000);
      }

      function envdata() {
        var form = document.getElementById('addytbchannel');
        if (!form.checkValidity()) {
          exibirMensagemErro('Por favor, preencha todos os campos obrigatórios.');
          return;
        }
        var dadosFormulario = $("#addytbchannel").serializeArray();
        parent.dtbaseReload(dadosFormulario);
      }
    </script>
  </body>
</html>
